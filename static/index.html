<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Manager</title>
    <link rel="stylesheet" href="static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
</head>

<body class="dark-theme">
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <span class="logo-icon">‚ñ≤</span>
                <h1>Prompt Manager</h1>
            </div>

            <nav class="sidebar-nav">
                <a href="#" id="nav-checker" class="nav-item active">
                    <span class="icon">üîç</span> Prompt Checker
                </a>
                <a href="#" id="nav-manage" class="nav-item">
                    <span class="icon">‚öôÔ∏è</span> Project and Environment Management
                </a>
                <a href="#" id="nav-settings" class="nav-item">
                    <span class="icon">üõ†Ô∏è</span> Settings
                </a>
            </nav>

            <div class="sidebar-section">
                <div class="nav-header">
                    <h2>Recent Projects</h2>
                    <button id="add-project-btn" title="Add Project">+</button>
                </div>
                <ul id="project-list">
                    <!-- Projects will be injected here -->
                </ul>
            </div>
            <div class="sidebar-footer"
                style="padding: 24px; border-top: 1px solid var(--border); font-size: 0.75rem; color: var(--text-dim); text-align: center;">
                <div class="footer">
                    Developed by <a href="https://github.com/Resynance" target="_blank">Max Turner (Resynance)</a>
                    <span id="app-version" style="opacity: 0.5; margin-left: 10px;"></span>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <!-- Prompt Checker View -->
            <section id="view-checker" class="view">
                <header class="content-header">
                    <div class="current-scope">
                        <span id="display-project">Select Project</span>
                        <span class="separator">/</span>
                        <span id="display-env">Select Env</span>
                    </div>
                </header>



                <div class="checker-container" style="display: flex; gap: 24px; padding: 24px;">
                    <div class="editor-section" style="flex: 1.5;">
                        <div class="card">
                            <div class="card-header">
                                <h3>Input Prompt</h3>
                            </div>
                            <div class="card-body">
                                <textarea id="prompt-editor" placeholder="Enter your prompt here..."
                                    style="width: 100%; height: 400px; background: transparent; border: none; color: white; outline: none; font-family: 'JetBrains Mono', monospace;"></textarea>
                            </div>
                            <div class="card-footer"
                                style="padding: 16px; border-top: 1px solid rgba(255,255,255,0.06); display: flex; justify-content: flex-end;">
                                <button id="run-check" class="primary-btn">Analyze Prompt</button>
                            </div>
                        </div>
                    </div>

                    <div class="results-section" id="results-area"
                        style="flex: 1; display: flex; flex-direction: column; gap: 24px;">
                        <div class="result-card card">
                            <div class="card-header">
                                <h3>Results</h3>
                            </div>
                            <div class="card-body">
                                Results will appear here after analysis.
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Management View -->
            <section id="view-manage" class="view" style="display: none;">
                <header class="content-header">
                    <h2>Project & Environment Management</h2>
                </header>

                <div class="management-container">
                    <div class="management-card card">
                        <div class="card-header">
                            <h3>All Projects</h3>
                            <button class="primary-btn sm" id="manage-add-project">Add Project</button>
                        </div>
                        <div class="table-wrapper">
                            <table id="projects-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Requirements</th>
                                        <th>Project Focus</th>
                                        <th>Created</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="projects-list-body">
                                    <!-- Projects will be injected here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="management-card card" id="env-manage-card" style="display: none; margin-top: 24px;">
                        <div class="card-header">
                            <h3>Environments for <span id="env-manage-project-name"></span></h3>
                            <button class="primary-btn sm" id="manage-add-env">Add Env</button>
                        </div>
                        <div class="table-wrapper">
                            <table id="envs-table">
                                <thead>
                                    <tr>
                                        <th>Environment Name</th>
                                        <th>Created</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="envs-list-body">
                                    <!-- Envs will be injected here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="view-settings" class="view" style="display: none;">
                <header class="content-header">
                    <h2>Global Settings</h2>
                </header>

                <div class="settings-container"
                    style="max-width: 800px; padding: 24px; display: flex; flex-direction: column; gap: 32px;">
                    <div class="card">
                        <div class="card-header">
                            <h3>Provider Configuration</h3>
                        </div>
                        <div class="card-body" style="padding: 24px;">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label style="display: block; margin-bottom: 8px; color: var(--text-dim);">LM Studio
                                    URL</label>
                                <input type="text" id="lm-studio-url" value="http://localhost:1234/v1"
                                    placeholder="e.g. http://localhost:1234/v1"
                                    style="width: 100%; padding: 12px; background: rgba(0,0,0,0.2); border: 1px solid var(--border); border-radius: 8px; color: white;">
                                <p style="margin-top: 8px; font-size: 0.8rem; color: var(--text-dim);">The base URL for
                                    LM Studio's OpenAI-compatible API.</p>
                            </div>
                        </div>
                    </div>

                    <div style="padding: 24px; border: 1px dashed #ef4444; border-radius: 12px; text-align: center;">
                        <h4 style="color: #ef4444; margin-bottom: 8px;">Technical Troubleshooting</h4>
                        <p style="color: var(--text-dim); font-size: 0.85rem; margin-bottom: 16px;">Switched embedding
                            models? Reset the prompt database to match the new dimensions.</p>
                        <button class="secondary-btn" style="color: #ef4444; border-color: #ef4444;"
                            onclick="resetPromptDatabase()">Reset Prompt Database</button>
                    </div>
                </div>
            </section>

            <footer class="app-footer">
                <div class="disclaimer-bar">
                    <span class="icon">‚ÑπÔ∏è</span>
                    <p>Feedback given here should not determine pass or fail for a prompt. Instead, it serves as an
                        additional review to compare the prompt against project requirements and spot any potential
                        similarities with earlier prompts.</p>
                </div>
            </footer>
        </main>
    </div>

    <!-- Modals -->
    <div id="project-modal" class="modal">
        <div class="modal-content">
            <h2>Manage Project</h2>
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="modal-project-name">
            </div>
            <div class="form-group">
                <label>Requirements <span style="color: #ef4444;">*</span></label>
                <div class="requirements-header"
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <span style="font-size: 0.85rem; color: var(--text-dim);">Enter text or import file</span>
                    <button id="import-pdf-btn" class="secondary-btn"
                        style="padding: 4px 12px; font-size: 0.75rem;">Import PDF</button>
                    <input type="file" id="pdf-upload" accept=".pdf" style="display: none;">
                </div>
                <textarea id="modal-project-reqs" placeholder="e.g. Must be JSON, informal tone..." required></textarea>
            </div>
            <div class="form-group">
                <label>Project Focus</label>
                <textarea id="modal-project-focus" placeholder="e.g. Security, Performance, User Engagement..."
                    style="height: 80px;"></textarea>
            </div>
            <div class="modal-actions">
                <button class="secondary-btn modal-close">Cancel</button>
                <button id="save-project-btn" class="primary-btn">Save Project</button>
            </div>
        </div>
    </div>

    <div id="env-modal" class="modal">
        <div class="modal-content">
            <h2>New Environment</h2>
            <div class="form-group">
                <label>Environment Name</label>
                <input type="text" id="modal-env-name" placeholder="e.g. Staging, Production">
            </div>
            <div class="modal-actions">
                <button class="secondary-btn modal-close">Cancel</button>
                <button id="save-env-btn" class="primary-btn">Create Environment</button>
            </div>
        </div>
    </div>

    <script src="static/script.js"></script>
</body>

</html>